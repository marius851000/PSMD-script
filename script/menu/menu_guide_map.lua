g_dt = {
  [0] = {
    title_img = "MAP_GUIDE_HOME00",
    map_img = "MAP_GUIDE_TOWN",
    aParam = {
      [0] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 210,
        img_ry = 130,
        img_offx = 48,
        img_offy = 48,
        l1 = -128,
        r1 = 128,
        l2 = -100,
        r2 = 100,
        z1 = -100,
        z2 = 100,
        after_trasform_y_rate = 0
      }
    }
  },
  [1] = {
    title_img = "MAP_GUIDE_HOME00",
    map_img = "MAP_GUIDE_AR010CROSS",
    aParam = {
      [0] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 210,
        img_ry = 130,
        img_offx = 48,
        img_offy = 48,
        l1 = -7,
        r1 = 7,
        l2 = -7,
        r2 = 7,
        z1 = 8,
        z2 = -5,
        after_trasform_y_rate = 0
      }
    }
  },
  [2] = {
    title_img = "MAP_GUIDE_HOME00",
    map_img = "MAP_GUIDE_HOME00",
    aParam = {
      [0] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 210,
        img_ry = 130,
        img_offx = 48,
        img_offy = 48,
        l1 = -6,
        r1 = 6,
        l2 = -6,
        r2 = 6,
        z1 = 4,
        z2 = -8,
        after_trasform_y_rate = 0
      }
    }
  },
  [3] = {
    title_img = "MAP_GUIDE_HOME00",
    map_img = "MAP_GUIDE_HOME01",
    aParam = {
      [0] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 210,
        img_ry = 130,
        img_offx = 48,
        img_offy = 48,
        l1 = -6,
        r1 = 6,
        l2 = -6,
        r2 = 6,
        z1 = 4,
        z2 = -8,
        after_trasform_y_rate = 0
      }
    }
  },
  [4] = {
    title_img = "MAP_GUIDE_HOME00",
    map_img = "MAP_GUIDE_HOME02",
    aParam = {
      [0] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 210,
        img_ry = 130,
        img_offx = 48,
        img_offy = 48,
        l1 = -6,
        r1 = 6,
        l2 = -6,
        r2 = 6,
        z1 = 4,
        z2 = -8,
        after_trasform_y_rate = 0
      }
    }
  },
  [5] = {
    title_img = "MAP_GUIDE_HOME00",
    map_img = "MAP_GUIDE_HOME03",
    aParam = {
      [0] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 210,
        img_ry = 130,
        img_offx = 48,
        img_offy = 48,
        l1 = -6,
        r1 = 6,
        l2 = -6,
        r2 = 6,
        z1 = 4,
        z2 = -8,
        after_trasform_y_rate = 0
      }
    }
  },
  [6] = {
    title_img = "MAP_GUIDE_HOME00",
    map_img = "MAP_GUIDE_CENTER00",
    aParam = {
      [0] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 210,
        img_ry = 130,
        img_offx = 48,
        img_offy = 48,
        l1 = -8.6,
        r1 = 8.6,
        l2 = -8.5,
        r2 = 8.5,
        z1 = 9,
        z2 = -5.6,
        after_trasform_y_rate = 0
      }
    }
  },
  [7] = {
    title_img = "MAP_GUIDE_HOME00",
    map_img = "MAP_GUIDE_CENTER01",
    aParam = {
      [0] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 210,
        img_ry = 130,
        img_offx = 48,
        img_offy = 48,
        l1 = -8.6,
        r1 = 8.6,
        l2 = -8.5,
        r2 = 8.5,
        z1 = 9,
        z2 = -5.6,
        after_trasform_y_rate = 0
      }
    }
  },
  [8] = {
    title_img = "MAP_GUIDE_HOME00",
    map_img = "MAP_GUIDE_CENTER02",
    aParam = {
      [0] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 210,
        img_ry = 130,
        img_offx = 48,
        img_offy = 48,
        l1 = -8.6,
        r1 = 8.6,
        l2 = -8.5,
        r2 = 8.5,
        z1 = 9,
        z2 = -5.6,
        after_trasform_y_rate = 0
      }
    }
  },
  [9] = {
    title_img = "MAP_GUIDE_HOME00",
    map_img = "MAP_GUIDE_CENTER03",
    aParam = {
      [0] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 210,
        img_ry = 130,
        img_offx = 48,
        img_offy = 48,
        l1 = -8.6,
        r1 = 8.6,
        l2 = -8.5,
        r2 = 8.5,
        z1 = 9,
        z2 = -5.6,
        after_trasform_y_rate = 0
      }
    }
  },
  [10] = {
    title_img = "MAP_GUIDE_EN010",
    map_img = "MAP_GUIDE_EN010",
    aParam = {
      [0] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 210,
        img_ry = 130,
        img_offx = 48,
        img_offy = 48,
        l1 = -15,
        r1 = 13.5,
        l2 = -15,
        r2 = 13.5,
        z1 = 38,
        z2 = 8,
        after_trasform_y_rate = -7
      }
    }
  },
  [11] = {
    title_img = "MAP_GUIDE_EN010",
    map_img = "MAP_GUIDE_EN020",
    aParam = {
      [0] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 210,
        img_ry = 130,
        img_offx = 48,
        img_offy = 48,
        l1 = -15,
        r1 = 15,
        l2 = -15,
        r2 = 15,
        z1 = 30,
        z2 = -10,
        after_trasform_y_rate = -5
      }
    }
  },
  [12] = {
    title_img = "MAP_GUIDE_EN010",
    map_img = "MAP_GUIDE_EN030",
    aParam = {
      [0] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 210,
        img_ry = 130,
        img_offx = 48,
        img_offy = 48,
        l1 = -13,
        r1 = 13,
        l2 = -13,
        r2 = 13,
        z1 = 36,
        z2 = 2,
        after_trasform_y_rate = -7
      }
    }
  },
  [13] = {
    title_img = "MAP_GUIDE_EN010",
    map_img = "MAP_GUIDE_EN040",
    aParam = {
      [0] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 40,
        img_ry = 40,
        img_offx = 200,
        img_offy = 154,
        l1 = -3.5,
        r1 = 6,
        l2 = -3.5,
        r2 = 6,
        z1 = 22.5,
        z2 = 5.5,
        after_trasform_y_rate = 0
      },
      [1] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 86,
        img_ry = 80,
        img_offx = 74,
        img_offy = 104,
        l1 = -9.5,
        r1 = 8.5,
        l2 = -9.5,
        r2 = 8.5,
        z1 = 36,
        z2 = 8.3,
        after_trasform_y_rate = 0
      },
      [2] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 68,
        img_ry = 66,
        img_offx = 170,
        img_offy = 56,
        l1 = -8,
        r1 = 10.8,
        l2 = -8,
        r2 = 10.8,
        z1 = 39,
        z2 = 10,
        after_trasform_y_rate = 0
      },
      [3] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 24,
        img_ry = 26,
        img_offx = 104,
        img_offy = 66,
        l1 = -11,
        r1 = 11,
        l2 = -11,
        r2 = 11,
        z1 = 30,
        z2 = -10,
        after_trasform_y_rate = 0
      }
    }
  },
  [14] = {
    title_img = "MAP_GUIDE_EN010",
    map_img = "MAP_GUIDE_EN051",
    aParam = {
      [0] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 210,
        img_ry = 130,
        img_offx = 48,
        img_offy = 48,
        l1 = -12,
        r1 = 12,
        l2 = -12,
        r2 = 12,
        z1 = 28,
        z2 = 0,
        after_trasform_y_rate = 0
      }
    }
  },
  [15] = {
    title_img = "MAP_GUIDE_EN010",
    map_img = "MAP_GUIDE_EN052",
    aParam = {
      [0] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 210,
        img_ry = 130,
        img_offx = 48,
        img_offy = 48,
        l1 = -12,
        r1 = 12,
        l2 = -12,
        r2 = 12,
        z1 = 28,
        z2 = 0,
        after_trasform_y_rate = 0
      }
    }
  },
  [16] = {
    title_img = "MAP_GUIDE_EN010",
    map_img = "MAP_GUIDE_EN053",
    aParam = {
      [0] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 210,
        img_ry = 130,
        img_offx = 48,
        img_offy = 48,
        l1 = -14,
        r1 = 8.5,
        l2 = -14,
        r2 = 8.5,
        z1 = 28,
        z2 = 5,
        after_trasform_y_rate = 0
      }
    }
  },
  [17] = {
    title_img = "MAP_GUIDE_EN010",
    map_img = "MAP_GUIDE_EN060",
    aParam = {
      [0] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 72,
        img_ry = 126,
        img_offx = 188,
        img_offy = 54,
        l1 = -2.8,
        r1 = 8.5,
        l2 = -3,
        r2 = 6,
        z1 = 38,
        z2 = 5.6,
        after_trasform_y_rate = 0
      },
      [1] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 52,
        img_ry = 132,
        img_offx = 132,
        img_offy = 44,
        l1 = -5,
        r1 = 2.7,
        l2 = -5,
        r2 = 4.6,
        z1 = 39.2,
        z2 = 1.1,
        after_trasform_y_rate = 0
      },
      [2] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 72,
        img_ry = 126,
        img_offx = 66,
        img_offy = 58,
        l1 = -8.4,
        r1 = 7.1,
        l2 = -1.3,
        r2 = 6.4,
        z1 = 38.5,
        z2 = 4.9,
        after_trasform_y_rate = 0
      }
    }
  },
  [18] = {
    title_img = "MAP_GUIDE_EN010",
    map_img = "MAP_GUIDE_EN070",
    aParam = {
      [0] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 210,
        img_ry = 130,
        img_offx = 48,
        img_offy = 48,
        l1 = -13,
        r1 = 13,
        l2 = -13,
        r2 = 15,
        z1 = 29,
        z2 = 2,
        after_trasform_y_rate = -8
      }
    }
  },
  [19] = {
    title_img = "MAP_GUIDE_EN010",
    map_img = "MAP_GUIDE_EN081",
    aParam = {
      [0] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 210,
        img_ry = 130,
        img_offx = 48,
        img_offy = 48,
        l1 = -12,
        r1 = 12,
        l2 = -12,
        r2 = 12,
        z1 = 28,
        z2 = 0,
        after_trasform_y_rate = 0
      }
    }
  },
  [20] = {
    title_img = "MAP_GUIDE_EN010",
    map_img = "MAP_GUIDE_EN082",
    aParam = {
      [0] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 210,
        img_ry = 130,
        img_offx = 48,
        img_offy = 48,
        l1 = -12,
        r1 = 12,
        l2 = -12,
        r2 = 12,
        z1 = 28,
        z2 = 0,
        after_trasform_y_rate = 0
      }
    }
  },
  [21] = {
    title_img = "MAP_GUIDE_EN010",
    map_img = "MAP_GUIDE_EN083",
    aParam = {
      [0] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 210,
        img_ry = 130,
        img_offx = 48,
        img_offy = 48,
        l1 = -14,
        r1 = 8.5,
        l2 = -14,
        r2 = 8.5,
        z1 = 28,
        z2 = 5,
        after_trasform_y_rate = 0
      }
    }
  },
  [22] = {
    title_img = "MAP_GUIDE_HOME00",
    map_img = "MAP_OUTPOST00WILD",
    aParam = {
      [0] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 210,
        img_ry = 130,
        img_offx = 48,
        img_offy = 48,
        l1 = -11,
        r1 = 11,
        l2 = -11,
        r2 = 11,
        z1 = 9,
        z2 = -5.6,
        after_trasform_y_rate = 0
      }
    }
  },
  [23] = {
    title_img = "MAP_GUIDE_HOME00",
    map_img = "MAP_OUTPOST01GRASS",
    aParam = {
      [0] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 210,
        img_ry = 130,
        img_offx = 48,
        img_offy = 48,
        l1 = -9.4,
        r1 = 9.6,
        l2 = -9.4,
        r2 = 8.8,
        z1 = 12.8,
        z2 = -3.5,
        after_trasform_y_rate = 0
      }
    }
  },
  [24] = {
    title_img = "MAP_GUIDE_HOME00",
    map_img = "MAP_OUTPOST02FOREST",
    aParam = {
      [0] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 210,
        img_ry = 130,
        img_offx = 48,
        img_offy = 48,
        l1 = -10,
        r1 = 9,
        l2 = -10,
        r2 = 9,
        z1 = 12,
        z2 = -4.6,
        after_trasform_y_rate = 0
      }
    }
  },
  [25] = {
    title_img = "MAP_GUIDE_HOME00",
    map_img = "MAP_OUTPOST03WATER",
    aParam = {
      [0] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 210,
        img_ry = 130,
        img_offx = 48,
        img_offy = 48,
        l1 = -9.8,
        r1 = 10.8,
        l2 = -9,
        r2 = 9,
        z1 = 11.8,
        z2 = -4.5,
        after_trasform_y_rate = 0
      }
    }
  },
  [26] = {
    title_img = "MAP_GUIDE_HOME00",
    map_img = "MAP_OUTPOST04ROCK",
    aParam = {
      [0] = {
        img_lx = 0,
        img_ly = 0,
        img_rx = 210,
        img_ry = 130,
        img_offx = 48,
        img_offy = 48,
        l1 = -10,
        r1 = 10,
        l2 = -9,
        r2 = 9,
        z1 = 11.8,
        z2 = -3.2,
        after_trasform_y_rate = 0
      }
    }
  }
}
gGuideMapParameter = {}
function GuideMap_Start()
  local landShopLabelIcon = {
    shop_farm_heal = "underIconShop23Set",
    shop_farm_oren = "underIconShop23Set",
    shop_farm_megusuri = "underIconShop23Set",
    shop_farm_fukkatsu = "underIconShop23Set",
    shop_farm_blind = "underIconShop23Set",
    shop_farm_quick = "underIconShop23Set",
    shop_farm_confuse = "underIconShop23Set",
    shop_farm_sleep = "underIconShop23Set",
    shop_farm_warp = "underIconShop23Set",
    shop_farm_blast = "underIconShop23Set",
    shop_farm_kouchoku = "underIconShop23Set",
    shop_farm_jaaku = "underIconShop23Set",
    shop_farm_pure = "underIconShop23Set",
    shop_farm_mougeki = "underIconShop23Set",
    shop_farm_tanren = "underIconShop23Set",
    shop_farm_hagemi = "underIconShop23Set",
    shop_recycle = "underIconShop24Set",
    shop_lottery = "underIconShop25Set",
    shop_special_merchant_plant = "underIconShop26Set",
    shop_special_merchant_throw = "underIconShop27Set",
    shop_special_merchant_orb = "underIconShop28Set",
    shop_select = "underIconShop29Set",
    shop_treasure_map = "underIconShop30Set",
    shop_wazatraining_normal = "underIconShop31Set",
    shop_wazatraining_fighting = "underIconShop31Set",
    shop_wazatraining_poison = "underIconShop31Set",
    shop_wazatraining_ground = "underIconShop31Set",
    shop_wazatraining_flying = "underIconShop31Set",
    shop_wazatraining_bug = "underIconShop31Set",
    shop_wazatraining_rock = "underIconShop31Set",
    shop_wazatraining_ghost = "underIconShop31Set",
    shop_wazatraining_steel = "underIconShop31Set",
    shop_wazatraining_fire = "underIconShop31Set",
    shop_wazatraining_water = "underIconShop31Set",
    shop_wazatraining_electric = "underIconShop31Set",
    shop_wazatraining_grass = "underIconShop31Set",
    shop_wazatraining_ice = "underIconShop31Set",
    shop_wazatraining_psychic = "underIconShop31Set",
    shop_wazatraining_dragon = "underIconShop31Set",
    shop_wazatraining_dark = "underIconShop31Set",
    shop_dispatch = "underIconShop32Set",
    shop_dig = "underIconShop33Set",
    shop_sideway_guide = "underIconShop34Set",
    shop_jukebox = "underIconShop35Set",
    minigame_dungeon_diver = "underIconShop36Set",
    minigame_salvage = "underIconShop37Set",
    minigame_curling = "underIconShop38Set"
  }
  local dt_icon_lock_play = {
    [0] = {
      [1] = {x = 158, y = 130},
      [2] = {x = 88, y = 130},
      [3] = {x = 164, y = 100},
      [4] = {x = 164, y = 64},
      [5] = {x = 128, y = 110}
    },
    [2] = {
      [1] = {x = 152, y = 110}
    },
    [3] = {
      [1] = {x = 152, y = 110}
    },
    [4] = {
      [1] = {x = 152, y = 110}
    },
    [5] = {
      [1] = {x = 152, y = 110}
    }
  }
  local dt_icon_town = {
    ["max"] = 7,
    [0] = {
      shopID = 0,
      x = 124,
      y = 95
    },
    [1] = {
      shopID = 3,
      x = 120,
      y = 136
    },
    [2] = {
      shopID = 1,
      x = 180,
      y = 110
    },
    [3] = {
      shopID = 4,
      x = 184,
      y = 136
    },
    [4] = {
      shopID = 2,
      x = 200,
      y = 120
    },
    [5] = {
      shopID = 5,
      x = 54,
      y = 120
    },
    [6] = {
      shopID = 6,
      x = 65,
      y = 98,
      peddler = 0
    }
  }
  local dt_icon_center = {
    {
      ["max"] = 4,
      [0] = {
        shopID = 20,
        x = 164,
        y = 142
      },
      [1] = {
        shopID = 3,
        x = 174,
        y = 98,
        checkactorr = "CHIRACHIINO"
      },
      [2] = {
        shopID = 4,
        x = 192,
        y = 108,
        checkactorr = "RAMUPARUDO"
      },
      [3] = {
        shopID = 5,
        x = 140,
        y = 90,
        checkactorr = "DESUKAAN"
      }
    },
    {
      ["max"] = 9,
      [0] = {
        shopID = 2,
        x = 216,
        y = 80
      },
      [1] = {
        shopID = 14,
        x = 230,
        y = 90
      },
      [2] = {
        shopID = 11,
        x = 170,
        y = 61
      },
      [3] = {
        shopID = 13,
        x = 190,
        y = 71
      },
      [4] = {
        shopID = 19,
        x = 230,
        y = 50
      },
      [5] = {
        shopID = 20,
        x = 164,
        y = 142
      },
      [6] = {
        shopID = 3,
        x = 174,
        y = 98,
        checkactorr = "CHIRACHIINO"
      },
      [7] = {
        shopID = 4,
        x = 192,
        y = 108,
        checkactorr = "RAMUPARUDO"
      },
      [8] = {
        shopID = 5,
        x = 140,
        y = 90,
        checkactorr = "DESUKAAN"
      }
    },
    {
      ["max"] = 11,
      [0] = {
        shopID = 2,
        x = 216,
        y = 80
      },
      [1] = {
        shopID = 14,
        x = 230,
        y = 90
      },
      [2] = {
        shopID = 16,
        x = 240,
        y = 120
      },
      [3] = {
        shopID = 15,
        x = 104,
        y = 128,
        open_event_flag = "shop_dottekotsu_open"
      },
      [4] = {
        shopID = 11,
        x = 170,
        y = 61
      },
      [5] = {
        shopID = 13,
        x = 190,
        y = 71
      },
      [6] = {
        shopID = 19,
        x = 230,
        y = 50
      },
      [7] = {
        shopID = 20,
        x = 164,
        y = 142
      },
      [8] = {
        shopID = 3,
        x = 174,
        y = 98,
        checkactorr = "CHIRACHIINO"
      },
      [9] = {
        shopID = 4,
        x = 192,
        y = 108,
        checkactorr = "RAMUPARUDO"
      },
      [10] = {
        shopID = 5,
        x = 140,
        y = 90,
        checkactorr = "DESUKAAN"
      }
    },
    {
      ["max"] = 14,
      [0] = {
        shopID = 2,
        x = 216,
        y = 80
      },
      [1] = {
        shopID = 14,
        x = 230,
        y = 90
      },
      [2] = {
        shopID = 16,
        x = 240,
        y = 120
      },
      [3] = {
        shopID = 15,
        x = 104,
        y = 128
      },
      [4] = {
        shopID = 17,
        x = 60,
        y = 130
      },
      [5] = {
        shopID = 11,
        x = 170,
        y = 61
      },
      [6] = {
        shopID = 12,
        x = 120,
        y = 61
      },
      [7] = {
        shopID = 13,
        x = 190,
        y = 71
      },
      [8] = {
        shopID = 18,
        x = 72,
        y = 72
      },
      [9] = {
        shopID = 19,
        x = 230,
        y = 50
      },
      [10] = {
        shopID = 20,
        x = 164,
        y = 142
      },
      [11] = {
        shopID = 3,
        x = 174,
        y = 98,
        checkactorr = "CHIRACHIINO"
      },
      [12] = {
        shopID = 4,
        x = 192,
        y = 108,
        checkactorr = "RAMUPARUDO"
      },
      [13] = {
        shopID = 5,
        x = 140,
        y = 90,
        checkactorr = "DESUKAAN"
      }
    }
  }
  gGuideMapParameter.data = g_dt
  gGuideMapParameter.lock = dt_icon_lock_play
  gGuideMapParameter.town = dt_icon_town
  gGuideMapParameter.center = dt_icon_center
  gGuideMapParameter.shopLavel = landShopLabelIcon
  gGuideMapParameter.shopObj = landShopObjTbl
  gGuideMapParameter.changeFlag = false
end
function GuideMap_GetMapImgSymbol(mapId)
  local st = g_dt[mapId].map_img
  return st
end
function GuideMap_CommonLoad()
  local wk_mapID, wk_posID
  wk_mapID = GROUND:GetGuideMapID()
  wk_posID = GROUND:GetGuidePosID()
  if GROUND:IsEncountField() then
  else
    SPRITE:CreatePatternSet("selMapCommonSet", {
      name = "underIconShop01Set",
      img = "ICON_MAP",
      u = 0,
      v = 16,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop02Set",
      img = "ICON_MAP",
      u = 24,
      v = 16,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop03Set",
      img = "ICON_MAP",
      u = 48,
      v = 16,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop04Set",
      img = "ICON_MAP",
      u = 72,
      v = 16,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop05Set",
      img = "ICON_MAP",
      u = 96,
      v = 16,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop06Set",
      img = "ICON_MAP",
      u = 120,
      v = 16,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop07Set",
      img = "ICON_MAP",
      u = 144,
      v = 16,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop08Set",
      img = "ICON_MAP",
      u = 144,
      v = 16,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop08Set",
      img = "ICON_MAP",
      u = 168,
      v = 16,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop09Set",
      img = "ICON_MAP",
      u = 192,
      v = 16,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop10Set",
      img = "ICON_MAP",
      u = 216,
      v = 16,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop11Set",
      img = "ICON_MAP",
      u = 0,
      v = 40,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop12Set",
      img = "ICON_MAP",
      u = 24,
      v = 40,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop13Set",
      img = "ICON_MAP",
      u = 48,
      v = 40,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop14Set",
      img = "ICON_MAP",
      u = 72,
      v = 40,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop15Set",
      img = "ICON_MAP",
      u = 96,
      v = 40,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop16Set",
      img = "ICON_MAP",
      u = 120,
      v = 40,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop17Set",
      img = "ICON_MAP",
      u = 144,
      v = 40,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop18Set",
      img = "ICON_MAP",
      u = 168,
      v = 40,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop19Set",
      img = "ICON_MAP",
      u = 192,
      v = 40,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop20Set",
      img = "ICON_MAP",
      u = 216,
      v = 40,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop21Set",
      img = "ICON_MAP",
      u = 0,
      v = 64,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop22Set",
      img = "ICON_MAP",
      u = 24,
      v = 64,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop23Set",
      img = "ICON_MAP",
      u = 48,
      v = 64,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop24Set",
      img = "ICON_MAP",
      u = 72,
      v = 64,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop25Set",
      img = "ICON_MAP",
      u = 96,
      v = 64,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop26Set",
      img = "ICON_MAP",
      u = 120,
      v = 64,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop27Set",
      img = "ICON_MAP",
      u = 144,
      v = 64,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop28Set",
      img = "ICON_MAP",
      u = 168,
      v = 64,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop29Set",
      img = "ICON_MAP",
      u = 192,
      v = 64,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop30Set",
      img = "ICON_MAP",
      u = 216,
      v = 64,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop31Set",
      img = "ICON_MAP",
      u = 0,
      v = 88,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop32Set",
      img = "ICON_MAP",
      u = 24,
      v = 88,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop33Set",
      img = "ICON_MAP",
      u = 48,
      v = 88,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop34Set",
      img = "ICON_MAP",
      u = 72,
      v = 88,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop35Set",
      img = "ICON_MAP",
      u = 96,
      v = 88,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop36Set",
      img = "ICON_MAP",
      u = 120,
      v = 88,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop37Set",
      img = "ICON_MAP",
      u = 144,
      v = 88,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop38Set",
      img = "ICON_MAP",
      u = 168,
      v = 88,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop39Set",
      img = "ICON_MAP",
      u = 192,
      v = 88,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "underIconShop40Set",
      img = "ICON_MAP",
      u = 216,
      v = 88,
      w = 24,
      h = 24,
      allocateFromMap = false
    }, {
      name = "PARA_SHOP_COUNTER",
      img = "MAP_OUTPOST_INST",
      u = 0,
      v = 0,
      w = 64,
      h = 64,
      cx = 34,
      cy = 38,
      allocateFromMap = false
    }, {
      name = "PARA_SHOP_HOUSE_1",
      img = "MAP_OUTPOST_INST",
      u = 64,
      v = 0,
      w = 64,
      h = 64,
      cx = 34,
      cy = 38,
      allocateFromMap = false
    }, {
      name = "PARA_SHOP_HOUSE_2",
      img = "MAP_OUTPOST_INST",
      u = 128,
      v = 0,
      w = 64,
      h = 64,
      cx = 34,
      cy = 38,
      allocateFromMap = false
    }, {
      name = "PARA_SHOP_DIVER",
      img = "MAP_OUTPOST_INST",
      u = 192,
      v = 0,
      w = 64,
      h = 64,
      cx = 34,
      cy = 38,
      allocateFromMap = false
    }, {
      name = "PARA_SHOP_HORIATE",
      img = "MAP_OUTPOST_INST",
      u = 0,
      v = 64,
      w = 64,
      h = 64,
      cx = 34,
      cy = 38,
      allocateFromMap = false
    }, {
      name = "PARA_SHOP_DOOM_1",
      img = "MAP_OUTPOST_INST",
      u = 64,
      v = 64,
      w = 64,
      h = 64,
      cx = 34,
      cy = 38,
      allocateFromMap = false
    }, {
      name = "PARA_SHOP_DOOM_2",
      img = "MAP_OUTPOST_INST",
      u = 128,
      v = 64,
      w = 64,
      h = 64,
      cx = 34,
      cy = 38,
      allocateFromMap = false
    }, {
      name = "PARA_SHOP_SALVAGE",
      img = "MAP_OUTPOST_INST",
      u = 192,
      v = 64,
      w = 64,
      h = 64,
      cx = 34,
      cy = 38,
      allocateFromMap = false
    }, {
      name = "PARA_SHOP_WAZA_TRAINING",
      img = "MAP_OUTPOST_INST",
      u = 0,
      v = 128,
      w = 64,
      h = 64,
      cx = 34,
      cy = 38,
      allocateFromMap = false
    }, {
      name = "PARA_SHOP_TENT_1",
      img = "MAP_OUTPOST_INST",
      u = 64,
      v = 128,
      w = 64,
      h = 64,
      cx = 34,
      cy = 38,
      allocateFromMap = false
    }, {
      name = "PARA_SHOP_TENT_2",
      img = "MAP_OUTPOST_INST",
      u = 128,
      v = 128,
      w = 64,
      h = 64,
      cx = 34,
      cy = 38,
      allocateFromMap = false
    }, {
      name = "PARA_SHOP_TAMAIRE",
      img = "MAP_OUTPOST_INST",
      u = 192,
      v = 128,
      w = 64,
      h = 64,
      cx = 34,
      cy = 38,
      allocateFromMap = false
    }, {
      name = "PARA_SHOP_MUSIC",
      img = "MAP_OUTPOST_INST",
      u = 0,
      v = 192,
      w = 64,
      h = 64,
      cx = 34,
      cy = 38,
      allocateFromMap = false
    }, {
      name = "PARA_SHOP_FARM_1",
      img = "MAP_OUTPOST_INST",
      u = 64,
      v = 192,
      w = 64,
      h = 64,
      cx = 34,
      cy = 38,
      allocateFromMap = false
    }, {
      name = "PARA_SHOP_FARM_2",
      img = "MAP_OUTPOST_INST",
      u = 128,
      v = 192,
      w = 64,
      h = 64,
      cx = 34,
      cy = 38,
      allocateFromMap = false
    })
  end
end
function GuideMap_Load()
  local wk_mapID, wk_posID, wk_homeLV, wk_tbl_home
  wk_mapID = GROUND:GetGuideMapID()
  wk_posID = GROUND:GetGuidePosID()
  wk_homeLV = GROUND:GetParadiseHomeLevel()
  if wk_homeLV == 1 then
    wk_tbl_home = {
      name = "small_home",
      img = "MAP_OUTPOST_ALL_LAND",
      u = 0,
      v = 0,
      w = 96,
      h = 64,
      isMul = false
    }
  elseif wk_homeLV == 2 then
    wk_tbl_home = {
      name = "small_home",
      img = "MAP_OUTPOST_ALL_LAND",
      u = 96,
      v = 0,
      w = 96,
      h = 64,
      isMul = false
    }
  else
    wk_tbl_home = {
      name = "small_home",
      img = "MAP_OUTPOST_ALL_LAND",
      u = 0,
      v = 64,
      w = 96,
      h = 64,
      isMul = false
    }
  end
  if GROUND:IsEncountField() then
    SPRITE:CreatePatternSet("selMapSet", {
      name = "underMapSet",
      img = gGuideMapParameter.data[wk_mapID].map_img,
      u = 0,
      v = 0,
      w = 256,
      h = 256,
      allocateFromMap = false
    }, {
      name = "underIconSet",
      img = "ICON_MAP",
      u = 0,
      v = 0,
      w = 16,
      h = 16,
      allocateFromMap = false
    })
  else
    SPRITE:CreatePatternSet("selMapSet", {
      name = "underMapSet",
      img = gGuideMapParameter.data[wk_mapID].map_img,
      u = 0,
      v = 0,
      w = 256,
      h = 256,
      allocateFromMap = false
    }, {
      name = "underIconSet",
      img = "ICON_MAP",
      u = 0,
      v = 0,
      w = 16,
      h = 16,
      allocateFromMap = false
    }, {
      name = "small_wild",
      img = "MAP_OUTPOST_ALL_LAND",
      u = 96,
      v = 64,
      w = 96,
      h = 64,
      isMul = false
    }, {
      name = "small_grass",
      img = "MAP_OUTPOST_ALL_LAND",
      u = 0,
      v = 128,
      w = 96,
      h = 64,
      isMul = false
    }, {
      name = "small_forest",
      img = "MAP_OUTPOST_ALL_LAND",
      u = 96,
      v = 128,
      w = 96,
      h = 64,
      isMul = false
    }, {
      name = "small_water",
      img = "MAP_OUTPOST_ALL_LAND",
      u = 0,
      v = 192,
      w = 96,
      h = 64,
      isMul = false
    }, {
      name = "small_rock",
      img = "MAP_OUTPOST_ALL_LAND",
      u = 96,
      v = 192,
      w = 96,
      h = 64,
      isMul = false
    }, wk_tbl_home)
  end
  SPRITE:CreateSprite("underIcon")
  SPRT("underIcon"):SetPattern({
    setName = "selMapSet",
    ptnName = "underIconSet",
    ofsX = 0,
    ofsY = 0,
    ofsPrio = 0
  })
  SPRT("underIcon"):SetOption({
    visible = false,
    prio = 560,
    screen = ScreenType.B
  })
  if wk_mapID == 3 then
    GuideMap_loadAllMap()
  elseif wk_mapID == 4 then
    GuideMap_loadAllMap()
  elseif wk_mapID == 5 then
    GuideMap_loadAllMap()
  elseif wk_mapID == 22 then
    GuideMap_loadAllMap()
  elseif wk_mapID == 23 then
    GuideMap_loadAllMap()
  elseif wk_mapID == 24 then
    GuideMap_loadAllMap()
  elseif wk_mapID == 25 then
    GuideMap_loadAllMap()
  elseif wk_mapID == 26 then
    GuideMap_loadAllMap()
  else
    GuideMap_loadOneMap()
  end
end
function GuideMap_Update()
  if gGuideMapParameter.playUpdate == true then
    GuideMapMenuIconSetPosition(GROUND:GetGuideMapPlayerPos())
  end
  SPRT("underIcon"):SetOption({visible = true})
end
function GuideMap_IsChangeMap()
  if gGuideMapParameter.changeFlag == true then
    return 1
  end
  return 0
end
function GuideMap_ChangeMap()
  if GuideMap_IsChangeMap() == 1 then
    GuideMap_EndSprite()
    SPRT("underIcon"):SetOption({visible = false})
    if gGuideMapParameter.loadOne == true then
      GuideMap_loadAllMap()
    else
      GuideMap_loadOneMap()
    end
  end
end
function GuideMap_EndSprite()
  SPRITE:DestroySprite("debugIcon")
  SPRITE:DestroySprite("underMapSet")
  SPRITE:DestroySprite("underMapBG")
  if gGuideMapParameter.loadOne == true then
    local landIndex = GROUND:GetNowLandIndex()
    if landIndex == PARADISE_LAND_INDEX.INDEX_HOME then
      SPRITE:DestroySprite(gGuideMapParameter.shopObj[landIndex].name_bg)
      SPRITE:DestroySprite(gGuideMapParameter.shopObj[landIndex][1].name)
    else
      SPRITE:DestroySprite(gGuideMapParameter.shopObj[landIndex].name_bg)
      SPRITE:DestroySprite(gGuideMapParameter.shopObj[landIndex][1].name)
      SPRITE:DestroySprite(gGuideMapParameter.shopObj[landIndex][2].name)
      SPRITE:DestroySprite(gGuideMapParameter.shopObj[landIndex][3].name)
      SPRITE:DestroySprite(gGuideMapParameter.shopObj[landIndex][4].name)
    end
  elseif gGuideMapParameter.btnObj then
    for i, btn in ipairs(gGuideMapParameter.btnObj) do
      if btn.landIndex == PARADISE_LAND_INDEX.INDEX_HOME then
        SPRITE:DestroySprite(gGuideMapParameter.shopObj[btn.landIndex].name_bg)
        SPRITE:DestroySprite(gGuideMapParameter.shopObj[btn.landIndex][1].name)
      else
        SPRITE:DestroySprite(gGuideMapParameter.shopObj[btn.landIndex].name_bg)
        SPRITE:DestroySprite(gGuideMapParameter.shopObj[btn.landIndex][1].name)
        SPRITE:DestroySprite(gGuideMapParameter.shopObj[btn.landIndex][2].name)
        SPRITE:DestroySprite(gGuideMapParameter.shopObj[btn.landIndex][3].name)
        SPRITE:DestroySprite(gGuideMapParameter.shopObj[btn.landIndex][4].name)
      end
    end
  end
end
function GuideMap_End()
  SPRITE:DestroySprite("underIconSet")
  SPRITE:DestroySprite("underIcon")
  for i = 0, 39 do
    SPRITE:DestroySprite(GetShopSpriteName(i))
  end
  GuideMap_EndSprite()
  SPRITE:DestroyPatternSet("selMapSet")
end
function GuideMap_CommonEnd()
  for i = 0, 39 do
    SPRITE:DestroySprite(GetShopSpritePtnName(i))
  end
  SPRITE:DestroySprite("PARA_SHOP_COUNTER")
  SPRITE:DestroySprite("PARA_SHOP_HOUSE_1")
  SPRITE:DestroySprite("PARA_SHOP_HOUSE_2")
  SPRITE:DestroySprite("PARA_SHOP_DIVER")
  SPRITE:DestroySprite("PARA_SHOP_HORIATE")
  SPRITE:DestroySprite("PARA_SHOP_DOME_1")
  SPRITE:DestroySprite("PARA_SHOP_DOME_2")
  SPRITE:DestroySprite("PARA_SHOP_SALVAGE")
  SPRITE:DestroySprite("PARA_SHOP_WAZA_TRAINING")
  SPRITE:DestroySprite("PARA_SHOP_TENT_1")
  SPRITE:DestroySprite("PARA_SHOP_TENT_2")
  SPRITE:DestroySprite("PARA_SHOP_TAMAIRE")
  SPRITE:DestroySprite("PARA_SHOP_MUSIC")
  SPRITE:DestroySprite("PARA_SHOP_FARM_1")
  SPRITE:DestroySprite("PARA_SHOP_FARM_2")
  SPRITE:DestroyPatternSet("selMapCommonSet")
end
function GuideMap_loadOneMap()
  local wk_mapID, wk_posID, wk_homeLV
  wk_mapID = GROUND:GetGuideMapID()
  wk_posID = GROUND:GetGuidePosID()
  wk_homeLV = GROUND:GetParadiseHomeLevel()
  gGuideMapParameter.loadOne = true
  SPRITE:CreateSprite("underMapBG")
  SPRT("underMapBG"):SetPattern({
    setName = "selMapSet",
    ptnName = "underMapSet",
    ofsX = 40,
    ofsY = 40,
    ofsPrio = 0
  })
  SPRT("underMapBG"):SetOption({
    visible = true,
    prio = 590,
    screen = ScreenType.B
  })
  if GROUND:IsEncountField() then
  else
    for i = 0, 39 do
      SPRITE:CreateSprite(GetShopSpriteName(i))
      SPRT(GetShopSpriteName(i)):SetPattern({
        setName = "selMapCommonSet",
        ptnName = GetShopSpritePtnName(i),
        ofsX = 0,
        ofsY = 0,
        ofsPrio = 0
      })
      SPRT(GetShopSpriteName(i)):SetOption({
        visible = false,
        prio = 570,
        screen = ScreenType.B
      })
    end
    if wk_mapID == 0 then
      GuideMapDrawIcon(gGuideMapParameter.town)
    elseif wk_mapID == 6 then
      GuideMapDrawIcon(gGuideMapParameter.center[1])
    elseif wk_mapID == 7 then
      GuideMapDrawIcon(gGuideMapParameter.center[2])
    elseif wk_mapID == 8 then
      GuideMapDrawIcon(gGuideMapParameter.center[3])
    elseif wk_mapID == 9 then
      GuideMapDrawIcon(gGuideMapParameter.center[4])
    elseif wk_mapID == 3 then
      GuideMapDrawParaIcon()
    elseif wk_mapID == 4 then
      GuideMapDrawParaIcon()
    elseif wk_mapID == 5 then
      GuideMapDrawParaIcon()
    elseif wk_mapID == 22 then
      GuideMapDrawParaIcon()
    elseif wk_mapID == 23 then
      GuideMapDrawParaIcon()
    elseif wk_mapID == 24 then
      GuideMapDrawParaIcon()
    elseif wk_mapID == 25 then
      GuideMapDrawParaIcon()
    elseif wk_mapID == 26 then
      GuideMapDrawParaIcon()
    end
  end
  if GROUND:GetGuidePosID() ~= 0 then
    SPRT("underIcon"):SetPattern({
      setName = "selMapSet",
      ptnName = "underIconSet",
      ofsX = gGuideMapParameter.lock[wk_mapID][wk_posID].x,
      ofsY = gGuideMapParameter.lock[wk_mapID][wk_posID].y
    })
    SPRT("underIcon"):SetOption({visible = false})
    gGuideMapParameter.playUpdate = false
  else
    gGuideMapParameter.playUpdate = true
  end
end
function GuideMap_loadAllMap()
  if FUNC_COMMON:IsDottekotsuOpen() == false then
    GuideMap_loadOneMap()
    return
  end
  local wk_mapID, wk_posID
  wk_mapID = GROUND:GetGuideMapID()
  wk_posID = GROUND:GetGuidePosID()
  gGuideMapParameter.changeFlag = true
  gGuideMapParameter.loadOne = false
  gGuideMapParameter.playUpdate = false
  local landShopIconPosTbl = {
    [-1] = {
      Vector2(48, 24),
      Vector2(0, 0),
      Vector2(0, 0),
      Vector2(0, 0),
      name = "small_home"
    },
    [PARADISE_LAND_TYPE.WILDERNESS] = {
      Vector2(0, 0),
      Vector2(0, 0),
      Vector2(0, 0),
      Vector2(0, 0),
      name = "small_wild"
    },
    [PARADISE_LAND_TYPE.PRAIRIE] = {
      Vector2(32, 16),
      Vector2(28, 44),
      Vector2(64, 16),
      Vector2(68, 44),
      name = "small_grass"
    },
    [PARADISE_LAND_TYPE.FOREST] = {
      Vector2(36, 20),
      Vector2(16, 32),
      Vector2(64, 28),
      Vector2(84, 36),
      name = "small_forest"
    },
    [PARADISE_LAND_TYPE.WATER] = {
      Vector2(40, 8),
      Vector2(20, 24),
      Vector2(72, 20),
      Vector2(48, 48),
      name = "small_water"
    },
    [PARADISE_LAND_TYPE.ROCKY_HILL] = {
      Vector2(36, 12),
      Vector2(36, 36),
      Vector2(64, 16),
      Vector2(64, 40),
      name = "small_rock"
    }
  }
  local btnTbl = {
    {
      rect = Rectangle(16, 24, 96, 64),
      link = {
        l = 2,
        r = 1,
        u = 6,
        d = 3
      },
      landIndex = PARADISE_LAND_INDEX.INDEX_00
    },
    {
      rect = Rectangle(112, 24, 96, 64),
      link = {
        l = 0,
        r = 2,
        u = 7,
        d = 4
      },
      landIndex = PARADISE_LAND_INDEX.INDEX_01
    },
    {
      rect = Rectangle(208, 24, 96, 64),
      link = {
        l = 1,
        r = 0,
        u = 8,
        d = 5
      },
      landIndex = PARADISE_LAND_INDEX.INDEX_02
    },
    {
      rect = Rectangle(16, 88, 96, 64),
      link = {
        l = 5,
        r = 4,
        u = 0,
        d = 6
      },
      landIndex = PARADISE_LAND_INDEX.INDEX_03
    },
    {
      rect = Rectangle(112, 88, 96, 64),
      link = {
        l = 3,
        r = 5,
        u = 1,
        d = 7
      },
      landIndex = PARADISE_LAND_INDEX.INDEX_04
    },
    {
      rect = Rectangle(208, 88, 96, 64),
      link = {
        l = 4,
        r = 3,
        u = 2,
        d = 8
      },
      landIndex = PARADISE_LAND_INDEX.INDEX_05
    },
    {
      rect = Rectangle(16, 152, 96, 64),
      link = {
        l = 8,
        r = 7,
        u = 3,
        d = 0
      },
      landIndex = PARADISE_LAND_INDEX.INDEX_06
    },
    {
      rect = Rectangle(112, 152, 96, 64),
      link = {
        l = 6,
        r = 8,
        u = 4,
        d = 1
      },
      landIndex = PARADISE_LAND_INDEX.INDEX_HOME
    },
    {
      rect = Rectangle(208, 152, 96, 64),
      link = {
        l = 7,
        r = 6,
        u = 5,
        d = 2
      },
      landIndex = PARADISE_LAND_INDEX.INDEX_07
    }
  }
  gGuideMapParameter.btnObj = btnTbl
  local landIndex
  landIndex = PARADISE_LAND_INDEX.INDEX_02
  local landIndex = GROUND:GetNowLandIndex()
  local spr, landType, iconPos, labelShop, iconPos
  for i, btn in ipairs(gGuideMapParameter.btnObj) do
    spr, landType = nil, nil
    if btn.landIndex == PARADISE_LAND_INDEX.INDEX_HOME then
      SPRITE:CreateSprite(gGuideMapParameter.shopObj[btn.landIndex].name_bg)
      SPRT(gGuideMapParameter.shopObj[btn.landIndex].name_bg):SetPattern({
        setName = "selMapSet",
        ptnName = landShopIconPosTbl[-1].name,
        ofsX = btn.rect.x,
        ofsY = btn.rect.y,
        ofsPrio = 0
      })
      SPRT(gGuideMapParameter.shopObj[btn.landIndex].name_bg):SetOption({
        visible = true,
        prio = 580,
        screen = ScreenType.B
      })
    else
      landType = GROUND:GetParadiseLandType(btn.landIndex)
      SPRITE:CreateSprite(gGuideMapParameter.shopObj[btn.landIndex].name_bg)
      SPRT(gGuideMapParameter.shopObj[btn.landIndex].name_bg):SetPattern({
        setName = "selMapSet",
        ptnName = landShopIconPosTbl[landType].name,
        ofsX = btn.rect.x,
        ofsY = btn.rect.y,
        ofsPrio = 0
      })
      SPRT(gGuideMapParameter.shopObj[btn.landIndex].name_bg):SetOption({
        visible = true,
        prio = 580,
        screen = ScreenType.B
      })
    end
    for spaceIdx = 1, 4 do
      if btn.landIndex ~= PARADISE_LAND_INDEX.INDEX_HOME and GROUND:IsLandShopExist(btn.landIndex, spaceIdx - 1) then
        iconPos = landShopIconPosTbl[landType][spaceIdx]
        labelShop = gGuideMapParameter.shopLavel[GROUND:GetLandShopLabel(btn.landIndex, spaceIdx - 1)]
        SPRITE:CreateSprite(gGuideMapParameter.shopObj[btn.landIndex][spaceIdx].name)
        SPRT(gGuideMapParameter.shopObj[btn.landIndex][spaceIdx].name):SetPattern({
          setName = "selMapCommonSet",
          ptnName = labelShop,
          ofsX = iconPos.x + (btn.rect.x - 12),
          ofsY = iconPos.y + (btn.rect.y - 12),
          ofsPrio = 0
        })
        SPRT(gGuideMapParameter.shopObj[btn.landIndex][spaceIdx].name):SetOption({
          visible = true,
          prio = 570,
          screen = ScreenType.B
        })
      elseif btn.landIndex == PARADISE_LAND_INDEX.INDEX_HOME and gGuideMapParameter.shopObj[btn.landIndex][spaceIdx] then
        iconPos = landShopIconPosTbl[-1][1]
        SPRITE:CreateSprite(gGuideMapParameter.shopObj[btn.landIndex][spaceIdx].name)
        SPRT(gGuideMapParameter.shopObj[btn.landIndex][spaceIdx].name):SetPattern({
          setName = "selMapCommonSet",
          ptnName = "underIconShop11Set",
          ofsX = iconPos.x + (btn.rect.x - 12),
          ofsY = iconPos.y + (btn.rect.y - 12),
          ofsPrio = 0
        })
        SPRT(gGuideMapParameter.shopObj[btn.landIndex][spaceIdx].name):SetOption({
          visible = true,
          prio = 570,
          screen = ScreenType.B
        })
      end
    end
    if btn.landIndex == landIndex then
      SPRT("underIcon"):SetPattern({
        setName = "selMapSet",
        ptnName = "underIconSet",
        ofsX = btn.rect.x + btn.rect.w / 2 - 8,
        ofsY = btn.rect.y + btn.rect.h / 2 - 8
      })
      SPRT("underIcon"):SetOption({visible = true})
    end
  end
end
function GuideMapDrawParaIcon()
  local scale = 2.5
  local landShopIconPosTbl = {
    [-1] = {
      Vector2(160, 88),
      Vector2(0, 0),
      Vector2(0, 0),
      Vector2(0, 0)
    },
    [PARADISE_LAND_TYPE.WILDERNESS] = {
      Vector2(0, 0),
      Vector2(0, 0),
      Vector2(0, 0),
      Vector2(0, 0)
    },
    [PARADISE_LAND_TYPE.PRAIRIE] = {
      Vector2(100, 76),
      Vector2(92, 124),
      Vector2(228, 76),
      Vector2(228, 132)
    },
    [PARADISE_LAND_TYPE.FOREST] = {
      Vector2(116, 76),
      Vector2(76, 100),
      Vector2(212, 76),
      Vector2(252, 108)
    },
    [PARADISE_LAND_TYPE.WATER] = {
      Vector2(124, 68),
      Vector2(76, 100),
      Vector2(204, 84),
      Vector2(164, 152)
    },
    [PARADISE_LAND_TYPE.ROCKY_HILL] = {
      Vector2(140, 36),
      Vector2(108, 92),
      Vector2(212, 44),
      Vector2(228, 116)
    }
  }
  local landShopPosTbl = {
    [-1] = {
      Vector2(0, 0),
      Vector2(0, 0),
      Vector2(0, 0),
      Vector2(0, 0)
    },
    [PARADISE_LAND_TYPE.WILDERNESS] = {
      Vector2(0, 0),
      Vector2(0, 0),
      Vector2(0, 0),
      Vector2(0, 0)
    },
    [PARADISE_LAND_TYPE.PRAIRIE] = {
      Vector2(128, 80),
      Vector2(112, 136),
      Vector2(208, 80),
      Vector2(208, 144)
    },
    [PARADISE_LAND_TYPE.FOREST] = {
      Vector2(136, 80),
      Vector2(96, 96),
      Vector2(200, 96),
      Vector2(240, 104)
    },
    [PARADISE_LAND_TYPE.WATER] = {
      Vector2(144, 56),
      Vector2(96, 96),
      Vector2(224, 88),
      Vector2(168, 176)
    },
    [PARADISE_LAND_TYPE.ROCKY_HILL] = {
      Vector2(128, 48),
      Vector2(128, 112),
      Vector2(200, 64),
      Vector2(216, 136)
    }
  }
  local landIndex = GROUND:GetNowLandIndex()
  local spaceIdxTbl = {
    PARADISE_SPACE_INDEX.INDEX_00,
    PARADISE_SPACE_INDEX.INDEX_01,
    PARADISE_SPACE_INDEX.INDEX_02,
    PARADISE_SPACE_INDEX.INDEX_03
  }
  for spaceIdx = 1, 4 do
    if landIndex ~= PARADISE_LAND_INDEX.INDEX_HOME and GROUND:IsLandShopExist(landIndex, spaceIdx - 1) then
      local landType = GROUND:GetParadiseLandType(landIndex)
      local iconPos = landShopIconPosTbl[landType][spaceIdx]
      local imgPos = landShopPosTbl[landType][spaceIdx]
      local labelShopIcon = gGuideMapParameter.shopLavel[GROUND:GetLandShopLabel(landIndex, spaceIdx - 1)]
      local labelShopImg = GROUND:GetLandShopGraphicLabel(landIndex, spaceIdxTbl[spaceIdx])
      iconPos.x = iconPos.x - 12
      iconPos.y = iconPos.y - 12
      SPRITE:CreateSprite(gGuideMapParameter.shopObj[landIndex][spaceIdx].name)
      SPRT(gGuideMapParameter.shopObj[landIndex][spaceIdx].name):SetPattern({
        setName = "selMapCommonSet",
        ptnName = labelShopIcon,
        ofsX = iconPos.x,
        ofsY = iconPos.y,
        ofsPrio = 0
      }, {
        setName = "selMapCommonSet",
        ptnName = labelShopImg,
        ofsX = imgPos.x,
        ofsY = imgPos.y,
        ofsPrio = 1
      })
      SPRT(gGuideMapParameter.shopObj[landIndex][spaceIdx].name):SetOption({
        visible = true,
        prio = 570,
        screen = ScreenType.B
      })
    elseif landIndex == PARADISE_LAND_INDEX.INDEX_HOME and gGuideMapParameter.shopObj[landIndex][spaceIdx] then
      local iconPos = landShopIconPosTbl[-1][1]
      iconPos.x = iconPos.x - 12
      iconPos.y = iconPos.y - 12
      SPRITE:CreateSprite(gGuideMapParameter.shopObj[landIndex][spaceIdx].name)
      SPRT(gGuideMapParameter.shopObj[landIndex][spaceIdx].name):SetPattern({
        setName = "selMapCommonSet",
        ptnName = "underIconShop11Set",
        ofsX = iconPos.x,
        ofsY = iconPos.y,
        ofsPrio = 0
      })
      SPRT(gGuideMapParameter.shopObj[landIndex][spaceIdx].name):SetOption({
        visible = true,
        prio = 570,
        screen = ScreenType.B
      })
    end
  end
end
function GuideMapDrawIcon(data)
  for i = 0, data.max - 1 do
    SPRT(GetShopSpriteName(data[i].shopID)):SetPattern({
      setName = "selMapCommonSet",
      ptnName = GetShopSpritePtnName(data[i].shopID),
      ofsX = data[i].x,
      ofsY = data[i].y
    })
    SPRT(GetShopSpriteName(data[i].shopID)):SetOption({visible = true})
    if data[i].checkactorr and GROUND:CheckGuideMapActor(data[i].checkactorr) == false then
      SPRT(GetShopSpriteName(data[i].shopID)):SetOption({visible = false})
    end
    if data[i].open_event_flag and FUNC_COMMON:CheckScenarioLevelOpenFlag(data[i].open_event_flag) == false then
      SPRT(GetShopSpriteName(data[i].shopID)):SetOption({visible = false})
    end
    if data[i].peddler and GROUND:GetPeddlerShopInstance(data[i].peddler) == NULL then
      SPRT(GetShopSpriteName(data[i].shopID)):SetOption({visible = false})
    end
  end
end
function GetShopSpriteName(shopID)
  if shopID == 0 then
    return "underIconShop01"
  elseif shopID == 1 then
    return "underIconShop02"
  elseif shopID == 2 then
    return "underIconShop03"
  elseif shopID == 3 then
    return "underIconShop04"
  elseif shopID == 4 then
    return "underIconShop05"
  elseif shopID == 5 then
    return "underIconShop06"
  elseif shopID == 6 then
    return "underIconShop07"
  elseif shopID == 7 then
    return "underIconShop08"
  elseif shopID == 8 then
    return "underIconShop09"
  elseif shopID == 9 then
    return "underIconShop10"
  elseif shopID == 10 then
    return "underIconShop11"
  elseif shopID == 11 then
    return "underIconShop12"
  elseif shopID == 12 then
    return "underIconShop13"
  elseif shopID == 13 then
    return "underIconShop14"
  elseif shopID == 14 then
    return "underIconShop15"
  elseif shopID == 15 then
    return "underIconShop16"
  elseif shopID == 16 then
    return "underIconShop17"
  elseif shopID == 17 then
    return "underIconShop18"
  elseif shopID == 18 then
    return "underIconShop19"
  elseif shopID == 19 then
    return "underIconShop20"
  elseif shopID == 20 then
    return "underIconShop21"
  elseif shopID == 21 then
    return "underIconShop22"
  elseif shopID == 22 then
    return "underIconShop23"
  elseif shopID == 23 then
    return "underIconShop24"
  elseif shopID == 24 then
    return "underIconShop25"
  elseif shopID == 25 then
    return "underIconShop26"
  elseif shopID == 26 then
    return "underIconShop27"
  elseif shopID == 27 then
    return "underIconShop28"
  elseif shopID == 28 then
    return "underIconShop29"
  elseif shopID == 29 then
    return "underIconShop30"
  elseif shopID == 30 then
    return "underIconShop31"
  elseif shopID == 31 then
    return "underIconShop32"
  elseif shopID == 32 then
    return "underIconShop33"
  elseif shopID == 33 then
    return "underIconShop34"
  elseif shopID == 34 then
    return "underIconShop35"
  elseif shopID == 35 then
    return "underIconShop36"
  elseif shopID == 36 then
    return "underIconShop37"
  elseif shopID == 37 then
    return "underIconShop38"
  elseif shopID == 38 then
    return "underIconShop39"
  elseif shopID == 39 then
    return "underIconShop40"
  else
    return "underIconShop01"
  end
end
function GetShopSpritePtnName(shopID)
  if shopID == 0 then
    return "underIconShop01Set"
  elseif shopID == 1 then
    return "underIconShop02Set"
  elseif shopID == 2 then
    return "underIconShop03Set"
  elseif shopID == 3 then
    return "underIconShop04Set"
  elseif shopID == 4 then
    return "underIconShop05Set"
  elseif shopID == 5 then
    return "underIconShop06Set"
  elseif shopID == 6 then
    return "underIconShop07Set"
  elseif shopID == 7 then
    return "underIconShop08Set"
  elseif shopID == 8 then
    return "underIconShop09Set"
  elseif shopID == 9 then
    return "underIconShop10Set"
  elseif shopID == 10 then
    return "underIconShop11Set"
  elseif shopID == 11 then
    return "underIconShop12Set"
  elseif shopID == 12 then
    return "underIconShop13Set"
  elseif shopID == 13 then
    return "underIconShop14Set"
  elseif shopID == 14 then
    return "underIconShop15Set"
  elseif shopID == 15 then
    return "underIconShop16Set"
  elseif shopID == 16 then
    return "underIconShop17Set"
  elseif shopID == 17 then
    return "underIconShop18Set"
  elseif shopID == 18 then
    return "underIconShop19Set"
  elseif shopID == 19 then
    return "underIconShop20Set"
  elseif shopID == 20 then
    return "underIconShop21Set"
  elseif shopID == 21 then
    return "underIconShop22Set"
  elseif shopID == 22 then
    return "underIconShop23Set"
  elseif shopID == 23 then
    return "underIconShop24Set"
  elseif shopID == 24 then
    return "underIconShop25Set"
  elseif shopID == 25 then
    return "underIconShop26Set"
  elseif shopID == 26 then
    return "underIconShop27Set"
  elseif shopID == 27 then
    return "underIconShop28Set"
  elseif shopID == 28 then
    return "underIconShop29Set"
  elseif shopID == 29 then
    return "underIconShop30Set"
  elseif shopID == 30 then
    return "underIconShop31Set"
  elseif shopID == 31 then
    return "underIconShop32Set"
  elseif shopID == 32 then
    return "underIconShop33Set"
  elseif shopID == 33 then
    return "underIconShop34Set"
  elseif shopID == 34 then
    return "underIconShop35Set"
  elseif shopID == 35 then
    return "underIconShop36Set"
  elseif shopID == 36 then
    return "underIconShop37Set"
  elseif shopID == 37 then
    return "underIconShop38Set"
  elseif shopID == 38 then
    return "underIconShop39Set"
  elseif shopID == 39 then
    return "underIconShop40Set"
  else
    return "underIconShop01Set"
  end
end
function GuideMapMenuIconSetPosition(vec3)
  local wk_mapID
  wk_mapID = GROUND:GetGuideMapID()
  local wk_areaID = GROUND:GetGuideAreaID()
  local vec2 = GuideMapMenu3Dto2D(vec3, wk_mapID, wk_areaID)
  SPRT("underIcon"):SetPattern({
    setName = "selMapSet",
    ptnName = "underIconSet",
    ofsX = vec2.x,
    ofsY = vec2.y
  })
end
function GuideMapMenu3Dto2D(vec3, mapID, areaID)
  if areaID < 0 or areaID >= table.maxn(gGuideMapParameter.data[mapID].aParam) + 1 then
    areaID = 0
    SYSTEM:DebugPrint(string.format("guide map areaID error %d %d", mapID, table.maxn(gGuideMapParameter.data[mapID].aParam)))
  end
  local wk_x, wk_y, wk_fx, wk_fw1, wk_fw2, wk_fy, wk_w1, wk_w2, wk_w3, wk_h
  local img_lx = gGuideMapParameter.data[mapID].aParam[areaID].img_lx
  local img_ly = gGuideMapParameter.data[mapID].aParam[areaID].img_ly
  local img_rx = gGuideMapParameter.data[mapID].aParam[areaID].img_rx
  local img_ry = gGuideMapParameter.data[mapID].aParam[areaID].img_ry
  local img_offx = gGuideMapParameter.data[mapID].aParam[areaID].img_offx
  local img_offy = gGuideMapParameter.data[mapID].aParam[areaID].img_offy
  wk_x = vec3.x
  wk_y = vec3.z
  wk_h = gGuideMapParameter.data[mapID].aParam[areaID].z2 - gGuideMapParameter.data[mapID].aParam[areaID].z1
  wk_w1 = gGuideMapParameter.data[mapID].aParam[areaID].l2 - gGuideMapParameter.data[mapID].aParam[areaID].l1
  wk_w2 = gGuideMapParameter.data[mapID].aParam[areaID].r1 - gGuideMapParameter.data[mapID].aParam[areaID].r2
  wk_w3 = gGuideMapParameter.data[mapID].aParam[areaID].r2 - gGuideMapParameter.data[mapID].aParam[areaID].l2
  wk_fy = (vec3.z - gGuideMapParameter.data[mapID].aParam[areaID].z1) / wk_h
  wk_fw1 = wk_w1 * wk_fy
  wk_fw2 = (wk_w1 + wk_w2) * wk_fy + wk_w3
  wk_fx = (vec3.x - (gGuideMapParameter.data[mapID].aParam[areaID].l2 - wk_fw1)) / wk_fw2
  wk_x = img_rx * wk_fx
  wk_y = img_ry * (1 - wk_fy)
  wk_y = wk_y + vec3.y * gGuideMapParameter.data[mapID].aParam[areaID].after_trasform_y_rate
  if img_lx > wk_x then
    wk_x = img_lx
  end
  if img_rx < wk_x then
    wk_x = img_rx
  end
  if img_ly > wk_y then
    wk_y = img_ly
  end
  if img_ry < wk_y then
    wk_y = img_ry
  end
  return Vector2(wk_x + img_offx, wk_y + img_offy)
end
